<!DOCTYPE html>
<html>
  <head>
    <title> Source </title>
    <link rel="stylesheet" href="../style/source.css">
  </head>
  <body>
    <div id="index-frontend" class="sourcediv">
        <h3>index-frontend.js</h3>
        <div class="code">
        document.addEventListener("DOMContentLoaded", function(event){
            require("../scripts/math.js");
            require("../scripts/onclick.js");
            require("../scripts/vars.js");
            require("../scripts/showResult.js");
           });
         
           function require(script) {
             $.ajax({
                 url: script,
                 dataType: "script",
                 async: false,           
                 success: function () {
                     // all good...
                 },
                 error: function () {
                     throw new Error("Could not load script " + script);
                 }
             });
         }
        </div>
    </div>
    <div id="math" class="sourcediv">
        <h3>math.js</h3>
        <div class="code">
            function math(op){
                setVariables();
                $.ajax({
                        url:"https://derandy-php.herokuapp.com/"+op+".php",    //the page containing php script
                        type: "post",    //request type,
                        dataType: 'json',
                        data: {x: xval, y: yval},
                        success:function(result){
                            showResult(result);
                        },
                        error:function(){
                            showResult("ERROR");
                        }
                    });
            }
        </div>
    </div>

    <div id="onclick" class="sourcediv">
        <h3>onclick.js</h3>
        <div class="code">
            document.getElementById("add").onclick=function(){math("add")};
            document.getElementById("multiply").onclick=function(){math("multiply")};
            document.getElementById("sub1").onclick=function(){math("subtract1")};
            document.getElementById("sub2").onclick=function(){math("subtract2")};
            document.getElementById("div1").onclick=function(){math("divide1")};
            document.getElementById("div2").onclick=function(){math("divide2")};
        </div>
    </div>

    <div id="showResult" class="sourcediv">
        <h3>showResult.js</h3>
        <div class="code">
            function showResult(result){
                document.getElementById("ergebnisline").innerHTML = result;
                document.getElementById("x").value = 0;
                document.getElementById("y").value = 0;
            } 
        </div>
    </div>

    <div id="vars" class="sourcediv">
        <h3>vars.js</h3>
        <div class="code">
            let xval = 0;
            let yval = 0;
            
            function setX(){
                xval = document.getElementById("x").value;
            }
            
            function setY(){
                yval = document.getElementById("y").value;
            }
            
            function setVariables(){
                setX();
                setY();
            }
        </div>
    </div>

  </body>
</html>